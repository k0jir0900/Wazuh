<!--
  -  Modsecurity rules
  -  Author: Daniel Olivares.
  -  Copyright (C) 2015-2020, Wazuh Inc.
  -  This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2.
-->

<group name="waf,modsecurity,">
  <rule id="101000" level="3">
    <decoded_as>json</decoded_as>
    <description>Modsecurity event</description>
    <group>modsecurity</group>
  </rule>

<!-- HTTP CODE -->

<rule id="101010" level="3">
     <if_sid>101000</if_sid>
     <field name="transaction.response.http_code">^1</field>
     <description>ModSecurity: Informative</description>
     <group>http_code</group>
</rule>

<rule id="101011" level="3">
     <if_sid>101000</if_sid>
     <field name="transaction.response.http_code">^2</field>
     <description>ModSecurity: Success</description>
     <group>http_code</group>
</rule>

<rule id="101012" level="3">
     <if_sid>101000</if_sid>
     <field name="transaction.response.http_code">^3</field>
     <description>ModSecurity: Redirection</description>
     <group>http_code</group>
</rule>

<rule id="101013" level="3">
     <if_sid>101000</if_sid>
     <field name="transaction.response.http_code">^4</field>
     <description>ModSecurity: Client Errors</description>
     <group>http_code</group>
</rule>

<rule id="101014" level="3">
     <if_sid>101000</if_sid>
     <field name="transaction.response.http_code">^5</field>
     <description>ModSecurity: Server Errors</description>
 </rule>

<!-- ModSecurity Rule -->

<rule id="101101" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf</field>
     <description>ModSecurity Rule: REQUEST-900-EXCLUSION-RULES-BEFORE-CRS</description>
     <group>EXCLUSION-RULES-BEFORE-CRS</group>
</rule>

<rule id="101110" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-910-IP-REPUTATION.conf</field>
     <description>ModSecurity Rule: REQUEST-910-IP-REPUTATION</description>
     <group>IP-REPUTATION</group>
</rule>

<rule id="101111" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-911-METHOD-ENFORCEMENT.conf</field>
     <description>ModSecurity Rule: REQUEST-911-METHOD-ENFORCEMENT</description>
     <group>METHOD-ENFORCEMENT</group>
</rule>

<rule id="100112" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-912-DOS-PROTECTION.conf</field>
     <description>ModSecurity Rule: REQUEST-912-DOS-PROTECTION</description>
     <group>DOS-PROTECTION</group>
</rule>

<rule id="101113" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-913-SCANNER-DETECTION.conf</field>
     <description>ModSecurity Rule: REQUEST-913-SCANNER-DETECTION</description>
     <group>SCANNER-DETECTION</group>
</rule>

<rule id="101114" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-914-BAD-COOKIE-DETECTION.conf</field>
     <description>ModSecurity Rule: REQUEST-914-BAD-COOKIE-DETECTION</description>
     <group>BAD-COOKIE-DETECTION</group>
</rule>

<rule id="101115" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-915-BAD-REQUEST-DETECTION.conf</field>
     <description>ModSecurity Rule: REQUEST-915-BAD-REQUEST-DETECTION</description>
     <group>BAD-REQUEST-DETECTION</group>
</rule>

<rule id="101120" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-920-PROTOCOL-ENFORCEMENT.conf</field>
     <description>ModSecurity Rule: REQUEST-920-PROTOCOL-ENFORCEMENT</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="101121" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-921-PROTOCOL-ATTACK.conf</field>
     <description>ModSecurity Rule: REQUEST-921-PROTOCOL-ATTACK</description>
     <group>PROTOCOL-ATTACK</group>
</rule>

<rule id="101130" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-930-APPLICATION-ATTACK-LFI.conf</field>
     <description>ModSecurity Rule: REQUEST-930-APPLICATION-ATTACK-LFI</description>
     <group>APPLICATION-ATTACK-LFI</group>
</rule>

<rule id="101131" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-931-APPLICATION-ATTACK-RFI.conf</field>
     <description>ModSecurity Rule: REQUEST-931-APPLICATION-ATTACK-RFI</description>
     <group>APPLICATION-ATTACK-RFI</group>
</rule>

<rule id="101132" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-932-APPLICATION-ATTACK-RCE.conf</field>
     <description>ModSecurity Rule: REQUEST-932-APPLICATION-ATTACK-RCE</description>
     <group>APPLICATION-ATTACK-RCE</group>
</rule>

<rule id="101133" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-933-APPLICATION-ATTACK-PHP.conf</field>
     <description>ModSecurity Rule: REQUEST-933-APPLICATION-ATTACK-PHP</description>
     <group>APPLICATION-ATTACK-PHP</group>
</rule>

<rule id="101134" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-934-APPLICATION-ATTACK-NODEJS.conf</field>
     <description>ModSecurity Rule: REQUEST-934-APPLICATION-ATTACK-NODEJS</description>
     <group>APPLICATION-ATTACK-NODEJS</group>
</rule>

<rule id="101141" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-941-APPLICATION-ATTACK-XSS.conf</field>
     <description>ModSecurity Rule: REQUEST-941-APPLICATION-ATTACK-XSS</description>
     <group>APPLICATION-ATTACK-XSS</group>
</rule>

<rule id="101142" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-942-APPLICATION-ATTACK-SQLI.conf</field>
     <description>ModSecurity Rule: REQUEST-942-APPLICATION-ATTACK-SQLI</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="101143" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION.conf</field>
     <description>ModSecurity Rule: REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION</description>
     <group>APPLICATION-ATTACK-SESSION-FIXATION</group>
</rule>

<rule id="101144" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-944-APPLICATION-ATTACK-JAVA.conf</field>
     <description>ModSecurity Rule: REQUEST-944-APPLICATION-ATTACK-JAVA</description>
     <group>APPLICATION-ATTACK-JAVA</group>
</rule>

<rule id="101149" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">REQUEST-949-BLOCKING-EVALUATION.conf</field>
     <description>ModSecurity Rule: REQUEST-949-BLOCKING-EVALUATION</description>
     <group>BLOCKING-EVALUATION</group>
</rule>

<rule id="101150" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">RESPONSE-950-DATA-LEAKAGES.conf</field>
     <description>ModSecurity Rule: RESPONSE-950-DATA-LEAKAGES</description>
     <group>DATA-LEAKAGES</group>
</rule>

<rule id="101151" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">RESPONSE-951-DATA-LEAKAGES-SQL.conf</field>
     <description>ModSecurity Rule: RESPONSE-951-DATA-LEAKAGES-SQL</description>
     <group>DATA-LEAKAGES-SQL</group>
</rule>

<rule id="101152" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">RESPONSE-952-DATA-LEAKAGES-JAVA.conf</field>
     <description>ModSecurity Rule: RESPONSE-952-DATA-LEAKAGES-JAVA</description>
     <group>DATA-LEAKAGES-JAVA</group>
</rule>

<rule id="101153" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">RESPONSE-953-DATA-LEAKAGES-PHP.conf</field>
     <description>ModSecurity Rule: RESPONSE-953-DATA-LEAKAGES-PHP</description>
     <group>DATA-LEAKAGES-PHP</group>
</rule>

<rule id="101154" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">RESPONSE-954-DATA-LEAKAGES-IIS.conf</field>
     <description>ModSecurity Rule: RESPONSE-954-DATA-LEAKAGES-IIS</description>
     <group>DATA-LEAKAGES-IIS</group>
</rule>

<rule id="101159" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">RESPONSE-959-BLOCKING-EVALUATION.conf</field>
     <description>ModSecurity Rule: RESPONSE-959-BLOCKING-EVALUATION</description>
     <group>BLOCKING-EVALUATION</group>
</rule>

<rule id="101180" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.messages">RESPONSE-980-CORRELATION.conf</field>
     <description>ModSecurity Rule: RESPONSE-980-CORRELATION.conf</description>
     <group>CORRELATION</group>
</rule>

<!-- REQUEST-900-EXCLUSION-RULES-BEFORE-CRS -->

<rule id="101200" level="5">
     <if_sid>101101</if_sid>
     <field name="transaction.request.headers.User-Agent">Minemeld</field>
     <field name="transaction.response.http_code">^2</field>     
     <description>ModSecurity: EDL Update - Success</description>
     <group>EXCLUSION-RULES-BEFORE-CRS</group>
</rule>

<rule id="101201" level="5">
     <if_sid>101101</if_sid>
     <field name="transaction.request.headers.User-Agent">Minemeld</field>
     <field name="transaction.response.http_code">^4</field> 
     <description>ModSecurity: EDL Update</description>
     <group>EXCLUSION-RULES-BEFORE-CRS</group>
</rule>

<!-- REQUEST-901 250 -->


<!-- REQUEST-902 300 -->


<!-- REQUEST-903 350 -->


<!-- REQUEST-904 400 -->


<!-- REQUEST-905 450 -->


<!-- REQUEST-906 500 -->


<!-- REQUEST-907 550 -->


<!-- REQUEST-908 600 -->


<!-- REQUEST-909 700 -->


<!-- REQUEST-910-IP-REPUTATION 800 -->
<rule id="101800" level="5">
     <if_sid>101110</if_sid>
     <field name="transaction.messages">Request from Known Malicious Client</field>
     <description>ModSecurity: REQ - Request from Known Malicious Client</description>
     <group>IP-REPUTATION</group>
</rule>

<rule id="101801" level="5">
     <if_sid>101110</if_sid>
     <field name="transaction.messages">Client IP is from a HIGH Risk Country Location</field>
     <description>ModSecurity: REQ - Client IP is from a HIGH Risk Country Location</description>
     <group>IP-REPUTATION</group>
</rule>

<rule id="101802" level="5">
     <if_sid>101110</if_sid>
     <field name="transaction.messages">Client IP in Trustwave SpiderLabs IP Reputation Blacklist</field>
     <description>ModSecurity: REQ - Client IP in Trustwave SpiderLabs IP Reputation Blacklist</description>
     <group>IP-REPUTATION</group>
</rule>

<rule id="101803" level="5">
     <if_sid>101110</if_sid>
     <field name="transaction.messages">Client IP in Trustwave SpiderLabs IP Reputation Blacklist</field>
     <description>ModSecurity: REQ - Client IP in Trustwave SpiderLabs IP Reputation Blacklist</description>
     <group>IP-REPUTATION</group>
</rule>

<rule id="101804" level="5">
     <if_sid>101110</if_sid>
     <field name="transaction.messages">HTTP Blacklist match for search engine IP</field>
     <description>ModSecurity: REQ - HTTP Blacklist match for search engine IP</description>
     <group>IP-REPUTATION</group>
  </rule>

<rule id="101805" level="5">
     <if_sid>101110</if_sid>
     <field name="transaction.messages">HTTP Blacklist match for spammer IP</field>
     <description>ModSecurity: REQ - HTTP Blacklist match for spammer IP</description>
     <group>IP-REPUTATION</group>
  </rule>

<rule id="101806" level="5">
     <if_sid>101110</if_sid>
     <field name="transaction.messages">HTTP Blacklist match for suspicious IP</field>
     <description>ModSecurity: REQ - HTTP Blacklist match for suspicious IP</description>
     <group>IP-REPUTATION</group>
  </rule>

<rule id="101807" level="5">
     <if_sid>101110</if_sid>
     <field name="transaction.messages">HTTP Blacklist match for harvester IP</field>
     <description>ModSecurity: REQ - HTTP Blacklist match for harvester IP</description>
     <group>IP-REPUTATION</group>
</rule>

<!-- REQUEST-911-METHOD-ENFORCEMENT 850 -->

<rule id="101850" level="5">
     <if_sid>101111</if_sid>
     <field name="transaction.messages">Method is not allowed by policy</field>
     <description>ModSecurity: REQ - Method is not allowed by policy</description>
     <group>METHOD-ENFORCEMENT</group>
</rule>

<!-- REQUEST-912-DOS-PROTECTION 900 -->

<rule id="101900" level="5">
  <if_sid>100112</if_sid>
  <field name="transaction.messages">Denial of Service (DoS) attack identified</field>
  <description>ModSecurity: REQ - Denial of Service (DoS) attack identified</description>
  <group>sev1,DOS-PROTECTION</group>
</rule>

<rule id="101901" level="5">
  <if_sid>100112</if_sid>
  <field name="transaction.messages">Potential Denial of Service (DoS) Attack</field>
  <description>ModSecurity: REQ - Potential Denial of Service (DoS) Attack</description>
  <group>sev1,DOS-PROTECTION</group>
</rule>

<!-- REQUEST-913-SCANNER-DETECTION 950 -->

<rule id="101950" level="5">
  <if_sid>101113</if_sid>
  <field name="transaction.messages">Found User-Agent associated with security scanner</field>
  <description>ModSecurity: REQ - Found User-Agent associated with security scanner</description>
  <group>SCANNER-DETECTION</group>
</rule>

<rule id="101951" level="5">
  <if_sid>101113</if_sid>
  <field name="transaction.messages">Found request header associated with security scanner</field>
  <description>ModSecurity: REQ - Found request header associated with security scanner</description>
  <group>SCANNER-DETECTION</group>
</rule>

<rule id="101952" level="5">
  <if_sid>101113</if_sid>
  <field name="transaction.messages">Found request filename/argument associated with security scanner</field>
  <description>ModSecurity: REQ - Found request filename/argument associated with security scanner</description>
  <group>SCANNER-DETECTION</group>
</rule>

<rule id="101953" level="5">
  <if_sid>101113</if_sid>
  <field name="transaction.messages">Found User-Agent associated with scripting/generic HTTP client</field>
  <description>ModSecurity: REQ - Found User-Agent associated with scripting/generic HTTP client</description>
  <group>SCANNER-DETECTION</group>
</rule>

<rule id="101954" level="5">
  <if_sid>101113</if_sid>
  <field name="transaction.messages">Found User-Agent associated with web crawler/bot</field>
  <description>ModSecurity: REQ - Found User-Agent associated with web crawler/bot</description>
  <group>SCANNER-DETECTION</group>
</rule>

<!-- REQUEST-914-BAD-COOKIE-DETECTION  000 -->

<rule id="102000" level="3">
  <if_sid>101114</if_sid>
  <field name="transaction.messages">Found Bad Cookie</field>
  <description>ModSecurity: REQ - Bad Cookie Found</description>
  <group>BAD-COOKIE-DETECTION</group>
</rule>

<!-- REQUEST-915-BAD-REQUEST-DETECTION 050 -->

<rule id="102050" level="3">
  <if_sid>101115</if_sid>
  <field name="transaction.messages">Bad Request Header Found</field>
  <description>ModSecurity: REQ - Bad Request Header Found</description>
  <group>BAD-REQUEST-DETECTION</group>
  </rule>

<!-- REQUEST-916 100 -->


<!-- REQUEST-917 150 -->


<!-- REQUEST-918 200 -->


<!-- REQUEST-919 250 -->


<!-- REQUEST-920-PROTOCOL-ENFORCEMENT 300 -->

<rule id="102300" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Invalid HTTP Request Line</field>
     <description>ModSecurity: REQ - Invalid HTTP Request Line</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102301" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Attempted multipart/form-data bypass</field>
     <description>ModSecurity: REQ - Attempted multipart/form-data bypass</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102302" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Content-Length HTTP header is not numeric</field>
     <description>ModSecurity: REQ - Content-Length HTTP header is not numeric</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102303" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">GET or HEAD Request with Body Content</field>
     <description>ModSecurity: REQ - GET or HEAD Request with Body Content</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102304" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">GET or HEAD Request with Transfer-Encoding</field>
     <description>ModSecurity: REQ - GET or HEAD Request with Transfer-Encoding</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102305" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">POST without Content-Length or Transfer-Encoding headers</field>
     <description>ModSecurity: REQ - POST without Content-Length or Transfer-Encoding headers</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102306" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Content-Length and Transfer-Encoding headers present</field>
     <description>ModSecurity: REQ - Content-Length and Transfer-Encoding headers present</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102307" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Range: Invalid Last Byte Value</field>
     <description>ModSecurity: REQ - Range: Invalid Last Byte Value</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102308" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Range: Invalid Last Byte Value</field>
     <description>ModSecurity: REQ - Range: Invalid Last Byte Value</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102309" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Multiple/Conflicting Connection Header Data Found</field>
     <description>ModSecurity: REQ - Multiple/Conflicting Connection Header Data Found</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102310" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">URL Encoding Abuse Attack Attempt</field>
     <description>ModSecurity: REQ - URL Encoding Abuse Attack Attempt</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102311" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">UTF8 Encoding Abuse Attack Attempt</field>
     <description>ModSecurity: REQ - UTF8 Encoding Abuse Attack Attempt</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102312" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Unicode Full/Half Width Abuse Attack Attempt</field>
     <description>ModSecurity: REQ - Unicode Full/Half Width Abuse Attack Attempt</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102313" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Invalid character in request</field>
     <description>ModSecurity: REQ - Invalid character in request (null character)</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102314" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Request Missing a Host Header</field>
     <description>ModSecurity: REQ - Request Missing a Host Header</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102315" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Empty Host Header</field>
     <description>ModSecurity: REQ - Empty Host Header</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102316" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Request Has an Empty Accept Header</field>
     <description>ModSecurity: REQ - Request Has an Empty Accept Header</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102317" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Empty User Agent Header</field>
     <description>ModSecurity: REQ - Empty User Agent Header</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102318" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Request Containing Content, but Missing Content-Type header</field>
     <description>ModSecurity: REQ - Request Containing Content, but Missing Content-Type header</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102319" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Host header is a numeric IP address</field>
     <description>ModSecurity: REQ - Host header is a numeric IP address</description>
     <group>web-attack_AR,PROTOCOL-ENFORCEMENT</group>    
</rule>

<rule id="102320" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Too many arguments in request</field>
     <description>ModSecurity: REQ - Too many arguments in request</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102321" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Argument name too long</field>
     <description>ModSecurity: REQ - Argument name too long</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102322" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Argument value too long</field>
     <description>ModSecurity: REQ - Argument value too long</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102323" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Total arguments size exceeded</field>
     <description>ModSecurity: REQ - Total arguments size exceeded</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102324" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Illegal Content-Type header</field>
     <description>ModSecurity: REQ - Illegal Content-Type header</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102325" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Request content type is not allowed by policy</field>
     <description>ModSecurity: REQ - Request content type is not allowed by policy</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102326" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Request content type charset is not allowed by policy</field>
     <description>ModSecurity: REQ - Request content type charset is not allowed by policy</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102327" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">HTTP protocol version is not allowed by policy</field>
     <description>ModSecurity: REQ - HTTP protocol version is not allowed by policy</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102328" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Range: Too many fields</field>
     <description>ModSecurity: REQ - Range: Too many fields (6 or more)</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102329" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Range: Too many fields for pdf request</field>
     <description>ModSecurity: REQ - Range: Too many fields for pdf request (63 or more)</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102330" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Multiple URL Encoding Detected</field>
     <description>ModSecurity: REQ - Multiple URL Encoding Detected</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102331" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Request Missing an Accept Header</field>
     <description>ModSecurity: REQ - Request Missing an Accept Header</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102332" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Invalid character in request</field>
     <description>ModSecurity: REQ - Invalid character in request (non printable characters)</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102333" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Missing User Agent Header</field>
     <description>ModSecurity: REQ - Missing User Agent Header</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102334" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Attempted multipart/form-data bypass</field>
     <description>ModSecurity: REQ - Attempted multipart/form-data bypass</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102335" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Request Containing Content Requires Content-Type header</field>
     <description>ModSecurity: REQ - Request Containing Content Requires Content-Type header</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102336" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Invalid character in request</field>
     <description>ModSecurity: REQ - Invalid character in request (outside of printable chars below ascii 127)</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102337" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Request header x-up-devcap-post-charset detected in combination with prefix</field>
     <description>ModSecurity: REQ - Request header x-up-devcap-post-charset detected in combination with prefix</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102338" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Invalid Cache-Control request header</field>
     <description>ModSecurity: REQ - Invalid Cache-Control request header</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102339" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Invalid character in request headers</field>
     <description>ModSecurity: REQ - Invalid character in request headers</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<rule id="102340" level="3">
     <if_sid>101120</if_sid>
     <field name="transaction.messages">Abnormal character escapes in request</field>
     <description>ModSecurity: REQ - Abnormal character escapes in request</description>
     <group>PROTOCOL-ENFORCEMENT</group>
</rule>

<!-- REQUEST-921-PROTOCOL-ATTACK 350 -->

<rule id="102350" level="3">
     <if_sid>101121</if_sid>
     <field name="transaction.messages">HTTP Request Smuggling Attack</field>
     <description>ModSecurity: REQ - HTTP Request Smuggling Attack</description>
     <group>PROTOCOL-ATTACK</group>
</rule>

<rule id="102351" level="3">
     <if_sid>101121</if_sid>
     <field name="transaction.messages">HTTP Response Splitting Attack</field>
     <description>ModSecurity: REQ - HTTP Response Splitting Attack</description>
     <group>PROTOCOL-ATTACK</group>
</rule>

<rule id="102352" level="3">
     <if_sid>101121</if_sid>
     <field name="transaction.messages">HTTP Header Injection Attack via headers</field>
     <description>ModSecurity: REQ - HTTP Header Injection Attack via headers</description>
     <group>PROTOCOL-ATTACK</group>
</rule>

<rule id="102353" level="3">
     <if_sid>101121</if_sid>
     <field name="transaction.messages">HTTP Header Injection Attack via headers</field>
     <description>ModSecurity: REQ - HTTP Header Injection Attack via headers</description>
     <group>PROTOCOL-ATTACK</group>
</rule>

<rule id="102354" level="3">
     <if_sid>101121</if_sid>
     <field name="transaction.messages">HTTP Header Injection Attack via payload</field>
     <description>ModSecurity: REQ - HTTP Header Injection Attack via payload</description>
     <group>PROTOCOL-ATTACK</group>
</rule>

<rule id="102355" level="3">
     <if_sid>101121</if_sid>
     <field name="transaction.messages">HTTP Splitting</field>
     <description>ModSecurity: REQ - HTTP Splitting</description>
     <group>PROTOCOL-ATTACK</group>
</rule>

<rule id="102356" level="3">
     <if_sid>101121</if_sid>
     <field name="transaction.messages">LDAP Injection Attack</field>
     <description>ModSecurity: REQ - LDAP Injection Attack</description>
     <group>PROTOCOL-ATTACK</group>
</rule>

<rule id="102357" level="3">
     <if_sid>101121</if_sid>
     <field name="transaction.messages">HTTP Header Injection Attack via payload</field>
     <description>ModSecurity: REQ - HTTP Header Injection Attack via payload</description>
     <group>PROTOCOL-ATTACK</group>
</rule>

<rule id="102358" level="3">
     <if_sid>101121</if_sid>
     <field name="transaction.messages">HTTP Parameter Pollution</field>
     <description>ModSecurity: REQ - HTTP Parameter Pollution</description>
     <group>PROTOCOL-ATTACK</group>
</rule>

<!-- REQUEST-930-APPLICATION-ATTACK-LFI 400 -->

<rule id="102400" level="3">
     <if_sid>101130</if_sid>
     <field name="transaction.messages">Path Traversal Attack</field>
     <description>ModSecurity: REQ - Path Traversal Attack</description>
     <group>APPLICATION-ATTACK-LFI</group>
</rule>

<rule id="102401" level="3">
     <if_sid>101130</if_sid>
     <field name="transaction.messages">OS File Access Attempt</field>
     <description>ModSecurity: REQ - OS File Access Attempt</description>
     <group>APPLICATION-ATTACK-LFI</group>
</rule>

<rule id="102402" level="3">
     <if_sid>101130</if_sid>
     <field name="transaction.messages">Restricted File Access Attempt</field>
     <description>ModSecurity: REQ - Restricted File Access Attempt</description>
     <group>APPLICATION-ATTACK-LFI</group>
</rule>

<!-- REQUEST-931-APPLICATION-ATTACK-RFI 450 -->

<rule id="102450" level="3">
     <if_sid>101131</if_sid>
     <field name="transaction.messages">Possible Remote File Inclusion (RFI) Attack: URL Parameter using IP Address</field>
     <description>ModSecurity: REQ - Possible Remote File Inclusion (RFI) Attack: URL Parameter using IP Address</description>
     <group>APPLICATION-ATTACK-RFI</group>
</rule>

<rule id="102451" level="3">
     <if_sid>101131</if_sid>
     <field name="transaction.messages">Possible Remote File Inclusion (RFI) Attack: Common RFI Vulnerable Parameter Name used w/URL Payload</field>
     <description>ModSecurity: REQ - Possible Remote File Inclusion (RFI) Attack: Common RFI Vulnerable Parameter Name used w/URL Payload</description>
     <group>APPLICATION-ATTACK-RFI</group>
</rule>

<rule id="102452" level="3">
     <if_sid>101131</if_sid>
     <field name="transaction.messages">Possible Remote File Inclusion (RFI) Attack: URL Payload Used w/Trailing Question Mark Character</field>
     <description>ModSecurity: REQ - Possible Remote File Inclusion (RFI) Attack: URL Payload Used w/Trailing Question Mark Character</description>
     <group>APPLICATION-ATTACK-RFI</group>
</rule>

<rule id="102453" level="3">
     <if_sid>101131</if_sid>
     <field name="transaction.messages">Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link</field>
     <description>ModSecurity: REQ - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link</description>
     <group>APPLICATION-ATTACK-RFI</group>
</rule>

<!-- REQUEST-932-APPLICATION-ATTACK-RCE 500 -->

<rule id="102500" level="3">
     <if_sid>101132</if_sid>
     <field name="transaction.messages">Remote Command Execution: Unix Command Injection</field>
     <description>ModSecurity: REQ - Remote Command Execution: Unix Command Injection</description>
     <group>APPLICATION-ATTACK-RCE</group>
</rule>

<rule id="102501" level="3">
     <if_sid>101132</if_sid>
     <field name="transaction.messages">Remote Command Execution: Windows Command Injection</field>
     <description>ModSecurity: REQ - Remote Command Execution: Windows Command Injection</description>
     <group>APPLICATION-ATTACK-RCE</group>
</rule>

<rule id="102502" level="3">
     <if_sid>101132</if_sid>
     <field name="transaction.messages">Remote Command Execution: Windows PowerShell Command Found</field>
     <description>ModSecurity: REQ - Remote Command Execution: Windows PowerShell Command Found</description>
     <group>APPLICATION-ATTACK-RCE</group>
</rule>

<rule id="102503" level="3">
     <if_sid>101132</if_sid>
     <field name="transaction.messages">Remote Command Execution: Unix Shell Expression Found</field>
     <description>ModSecurity: REQ - Remote Command Execution: Unix Shell Expression Found</description>
     <group>APPLICATION-ATTACK-RCE</group>
</rule>

<rule id="102504" level="3">
     <if_sid>101132</if_sid>
     <field name="transaction.messages">Remote Command Execution: Windows FOR/IF Command Found</field>
     <description>ModSecurity: REQ - Remote Command Execution: Windows FOR/IF Command Found</description>
     <group>APPLICATION-ATTACK-RCE</group>
</rule>

<rule id="102505" level="3">
     <if_sid>101132</if_sid>
     <field name="transaction.messages">Remote Command Execution: Direct Unix Command Execution</field>
     <description>ModSecurity: REQ - Remote Command Execution: Direct Unix Command Execution</description>
     <group>APPLICATION-ATTACK-RCE</group>
</rule>

<rule id="102506" level="3">
     <if_sid>101132</if_sid>
     <field name="transaction.messages">Remote Command Execution: Unix Shell Code Found</field>
     <description>ModSecurity: REQ - Remote Command Execution: Unix Shell Code Found</description>
     <group>APPLICATION-ATTACK-RCE</group>
</rule>

<rule id="102507" level="3">
     <if_sid>101132</if_sid>
     <field name="transaction.messages">Remote Command Execution: Shellshock</field>
     <description>ModSecurity: REQ - Remote Command Execution: Shellshock (CVE-2014-6271)</description>
     <group>APPLICATION-ATTACK-RCE</group>
</rule>

<rule id="102508" level="3">
     <if_sid>101132</if_sid>
     <field name="transaction.messages">Restricted File Upload Attempt</field>
     <description>ModSecurity: REQ - Restricted File Upload Attempt</description>
     <group>APPLICATION-ATTACK-RCE</group>
</rule>

<rule id="102509" level="3">
     <if_sid>101132</if_sid>
     <field name="transaction.messages">RCE Bypass Technique</field>
     <description>ModSecurity: REQ - RCE Bypass Technique</description>
     <group>APPLICATION-ATTACK-RCE</group>
</rule>

<rule id="102510" level="3">
     <if_sid>101132</if_sid>
     <field name="transaction.messages">Remote Command Execution: Wildcard bypass technique attempt</field>
     <description>ModSecurity: REQ - Remote Command Execution: Wildcard bypass technique attempt</description>
     <group>APPLICATION-ATTACK-RCE</group>
</rule>

<!-- REQUEST-933-APPLICATION-ATTACK-PHP 550 -->

<rule id="102550" level="3">
     <if_sid>101133</if_sid>
     <field name="transaction.messages">PHP Injection Attack: PHP Open Tag Found</field>
     <description>ModSecurity: REQ - PHP Injection Attack: PHP Open Tag Found</description>
     <group>APPLICATION-ATTACK-PHP</group>
</rule>

<rule id="102551" level="3">
     <if_sid>101133</if_sid>
     <field name="transaction.messages">PHP Injection Attack: PHP Script File Upload Found</field>
     <description>ModSecurity: REQ - PHP Injection Attack: PHP Script File Upload Found</description>
     <group>APPLICATION-ATTACK-PHP</group>
</rule>

<rule id="102552" level="3">
     <if_sid>101133</if_sid>
     <field name="transaction.messages">PHP Injection Attack: Configuration Directive Found</field>
     <description>ModSecurity: REQ - PHP Injection Attack: Configuration Directive Found</description>
     <group>APPLICATION-ATTACK-PHP</group>
</rule>

<rule id="102553" level="3">
     <if_sid>101133</if_sid>
     <field name="transaction.messages">PHP Injection Attack: Variables Found</field>
     <description>ModSecurity: REQ - PHP Injection Attack: Variables Found</description>
     <group>APPLICATION-ATTACK-PHP</group>
</rule>

<rule id="102554" level="3">
     <if_sid>101133</if_sid>
     <field name="transaction.messages">PHP Injection Attack: I/O Stream Found</field>
     <description>ModSecurity: REQ - PHP Injection Attack: I/O Stream Found</description>
     <group>APPLICATION-ATTACK-PHP</group>
</rule>

<rule id="102555" level="3">
     <if_sid>101133</if_sid>
     <field name="transaction.messages">PHP Injection Attack: Wrapper scheme detected</field>
     <description>ModSecurity: REQ - PHP Injection Attack: Wrapper scheme detected</description>
     <group>APPLICATION-ATTACK-PHP</group>
</rule>

<rule id="102556" level="3">
     <if_sid>101133</if_sid>
     <field name="transaction.messages">PHP Injection Attack: High-Risk PHP Function Name Found</field>
     <description>ModSecurity: REQ - PHP Injection Attack: High-Risk PHP Function Name Found</description>
     <group>APPLICATION-ATTACK-PHP</group>
</rule>

<rule id="102557" level="3">
     <if_sid>101133</if_sid>
     <field name="transaction.messages">PHP Injection Attack: High-Risk PHP Function Call Found</field>
     <description>ModSecurity: REQ - PHP Injection Attack: High-Risk PHP Function Call Found</description>
     <group>APPLICATION-ATTACK-PHP</group>
</rule>

<rule id="102558" level="3">
     <if_sid>101133</if_sid>
     <field name="transaction.messages">PHP Injection Attack: Serialized Object Injection</field>
     <description>ModSecurity: REQ - PHP Injection Attack: Serialized Object Injection</description>
     <group>APPLICATION-ATTACK-PHP</group>
</rule>

<rule id="102559" level="3">
     <if_sid>101133</if_sid>
     <field name="transaction.messages">PHP Injection Attack: Variable Function Call Found</field>
     <description>ModSecurity: REQ - PHP Injection Attack: Variable Function Call Found</description>
     <group>APPLICATION-ATTACK-PHP</group>
</rule>

<rule id="102560" level="3">
     <if_sid>101133</if_sid>
     <field name="transaction.messages">PHP Injection Attack: Medium-Risk PHP Function Name Found</field>
     <description>ModSecurity: REQ - PHP Injection Attack: Medium-Risk PHP Function Name Found</description>
     <group>APPLICATION-ATTACK-PHP</group>
</rule>

<rule id="102561" level="3">
     <if_sid>101133</if_sid>
     <field name="transaction.messages">PHP Injection Attack: Variables Found</field>
     <description>ModSecurity: REQ - PHP Injection Attack: Variables Found</description>
     <group>APPLICATION-ATTACK-PHP</group>
</rule>

<rule id="102562" level="3">
     <if_sid>101133</if_sid>
     <field name="transaction.messages">PHP Injection Attack: Low-Value PHP Function Call Found</field>
     <description>ModSecurity: REQ - PHP Injection Attack: Low-Value PHP Function Call Found</description>
     <group>APPLICATION-ATTACK-PHP</group>
</rule>

<rule id="102563" level="3">
     <if_sid>101133</if_sid>
     <field name="transaction.messages">PHP Injection Attack: PHP Script File Upload Found</field>
     <description>ModSecurity: REQ - PHP Injection Attack: PHP Script File Upload Found</description>
     <group>APPLICATION-ATTACK-PHP</group>
</rule>

<rule id="102564" level="3">
     <if_sid>101133</if_sid>
     <field name="transaction.messages">PHP Injection Attack: PHP Closing Tag Found</field>
     <description>ModSecurity: REQ - PHP Injection Attack: PHP Closing Tag Found</description>
     <group>APPLICATION-ATTACK-PHP</group>
</rule>

<!-- REQUEST-934-APPLICATION-ATTACK-NODEJS 600 -->

<rule id="102600" level="3">
     <if_sid>101134</if_sid>
     <field name="transaction.messages">Node.js Injection Attack</field>
     <description>ModSecurity: REQ - Node.js Injection Attack</description>
     <group>APPLICATION-ATTACK-NODEJS</group>
</rule>

<!-- REQUEST-941-APPLICATION-ATTACK-XSS 650 -->

<rule id="102650" level="3">
     <if_sid>101141</if_sid>
     <field name="transaction.messages">XSS Attack Detected via libinjection</field>
     <description>ModSecurity: REQ - XSS Attack Detected via libinjection</description>
     <group>APPLICATION-ATTACK-XSS</group>
</rule>

<rule id="102651" level="3">
     <if_sid>101141</if_sid>
     <field name="transaction.messages">XSS Filter - Category 1</field>
     <description>ModSecurity: REQ - XSS Filter - Category 1: Script Tag Vector</description>
     <group>APPLICATION-ATTACK-XSS</group>
</rule>

<rule id="102652" level="3">
     <if_sid>101141</if_sid>
     <field name="transaction.messages">XSS Filter - Category 2</field>
     <description>ModSecurity: REQ - XSS Filter - Category 2: Event Handler Vector</description>
     <group>APPLICATION-ATTACK-XSS</group>
</rule>

<rule id="102653" level="3">
     <if_sid>101141</if_sid>
     <field name="transaction.messages">XSS Filter - Category 3</field>
     <description>ModSecurity: REQ - XSS Filter - Category 3: Attribute Vector</description>
     <group>APPLICATION-ATTACK-XSS</group>
</rule>

<rule id="102654" level="3">
     <if_sid>101141</if_sid>
     <field name="transaction.messages">XSS Filter - Category 4</field>
     <description>ModSecurity: REQ - XSS Filter - Category 4: Javascript URI Vector</description>
     <group>APPLICATION-ATTACK-XSS</group>
</rule>

<rule id="102655" level="3">
     <if_sid>101141</if_sid>
     <field name="transaction.messages">NoScript XSS InjectionChecker: HTML Injection</field>
     <description>ModSecurity: REQ - NoScript XSS InjectionChecker: HTML Injection</description>
     <group>APPLICATION-ATTACK-XSS</group>
</rule>

<rule id="102656" level="3">
     <if_sid>101141</if_sid>
     <field name="transaction.messages">NoScript XSS InjectionChecker: Attribute Injection</field>
     <description>ModSecurity: REQ - NoScript XSS InjectionChecker: Attribute Injection</description>
     <group>APPLICATION-ATTACK-XSS</group>
</rule>

<rule id="102657" level="3">
     <if_sid>101141</if_sid>
     <field name="transaction.messages">Node-Validator Blacklist Keywords</field>
     <description>ModSecurity: REQ - Node-Validator Blacklist Keywords</description>
     <group>APPLICATION-ATTACK-XSS</group>
</rule>

<rule id="102658" level="3">
     <if_sid>101141</if_sid>
     <field name="transaction.messages">IE XSS Filters - Attack Detected</field>
     <description>ModSecurity: REQ - IE XSS Filters - Attack Detected</description>
     <group>APPLICATION-ATTACK-XSS</group>
</rule>

<rule id="102659" level="3">
     <if_sid>101141</if_sid>
     <field name="transaction.messages">US-ASCII Malformed Encoding XSS Filter - Attack Detected</field>
     <description>ModSecurity: REQ - US-ASCII Malformed Encoding XSS Filter - Attack Detected</description>
     <group>APPLICATION-ATTACK-XSS</group>
</rule>

<rule id="102660" level="3">
     <if_sid>101141</if_sid>
     <field name="transaction.messages">UTF-7 Encoding IE XSS - Attack Detected</field>
     <description>ModSecurity: REQ - UTF-7 Encoding IE XSS - Attack Detected</description>
     <group>APPLICATION-ATTACK-XSS</group>
</rule>

<rule id="102661" level="3">
     <if_sid>101141</if_sid>
     <field name="transaction.messages">Hieroglyphy obfuscation detected</field>
     <description>ModSecurity: REQ - JSFuck / Hieroglyphy obfuscation detected</description>
     <group>APPLICATION-ATTACK-XSS</group>
</rule>

<rule id="102662" level="3">
     <if_sid>101141</if_sid>
     <field name="transaction.messages">JavaScript global variable found</field>
     <description>ModSecurity: REQ - JavaScript global variable found</description>
     <group>APPLICATION-ATTACK-XSS</group>
</rule>

<!-- REQUEST-942-APPLICATION-ATTACK-SQLI 700 -->

<rule id="102700" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">SQL Injection Attack Detected via libinjection</field>
     <description>ModSecurity: REQ - SQL Injection Attack Detected via libinjection</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102701" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">SQL Injection Attack: Common DB Names Detected</field>
     <description>ModSecurity: REQ - SQL Injection Attack: Common DB Names Detected</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102702" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects blind sqli tests using sleep</field>
     <description>ModSecurity: REQ - Detects blind sqli tests using sleep() or benchmark()</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102703" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects SQL benchmark and sleep injection attempts including conditional queries</field>
     <description>ModSecurity: REQ - Detects SQL benchmark and sleep injection attempts including conditional queries</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102704" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects MSSQL code execution and information gathering attempts</field>
     <description>ModSecurity: REQ - Detects MSSQL code execution and information gathering attempts</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102705" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Looking for integer overflow attacks</field>
     <description>ModSecurity: REQ - Looking for integer overflow attacks</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102706" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects conditional SQL injection attempts</field>
     <description>ModSecurity: REQ - Detects conditional SQL injection attempts</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102707" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects MySQL charset switch and MSSQL DoS attempts</field>
     <description>ModSecurity: REQ - Detects MySQL charset switch and MSSQL DoS attempts</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102708" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects MATCH AGAINST, MERGE and EXECUTE IMMEDIATE injections</field>
     <description>ModSecurity: REQ - Detects MATCH AGAINST, MERGE and EXECUTE IMMEDIATE injections</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102709" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Looking for basic sql injection. Common attack string for mysql, oracle and others</field>
     <description>ModSecurity: REQ - Looking for basic sql injection. Common attack string for mysql, oracle and others</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102710" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects Postgres pg_sleep injection, waitfor delay attacks and database shutdown attempts</field>
     <description>ModSecurity: REQ - Detects Postgres pg_sleep injection, waitfor delay attacks and database shutdown attempts</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102711" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Finds basic MongoDB SQL injection attempts</field>
     <description>ModSecurity: REQ - Finds basic MongoDB SQL injection attempts</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102712" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects MySQL and PostgreSQL stored procedure/function injections</field>
     <description>ModSecurity: REQ - Detects MySQL and PostgreSQL stored procedure/function injections</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102713" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects MySQL UDF injection and other data/structure manipulation attempts</field>
     <description>ModSecurity: REQ - Detects MySQL UDF injection and other data/structure manipulation attempts</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102714" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects concatenated basic SQL injection and SQLLFI attempts</field>
     <description>ModSecurity: REQ - Detects concatenated basic SQL injection and SQLLFI attempts</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102715" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">MySQL in-line comment detected</field>
     <description>ModSecurity: REQ - MySQL in-line comment detected</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102716" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">SQL Injection Attack: Common Injection Testing Detected</field>
     <description>ModSecurity: REQ - SQL Injection Attack: Common Injection Testing Detected</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102717" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">SQL Injection Attack: SQL Operator Detected</field>
     <description>ModSecurity: REQ - SQL Injection Attack: SQL Operator Detected</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102718" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">SQL Injection Attack: SQL Tautology Detected</field>
     <description>ModSecurity: REQ - SQL Injection Attack: SQL Tautology Detected</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102719" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">SQL Injection Attack</field>
     <description>ModSecurity: REQ - SQL Injection Attack</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102720" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects basic SQL authentication bypass attempts</field>
     <description>ModSecurity: REQ - Detects basic SQL authentication bypass attempts</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102721" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects MySQL comment-/space-obfuscated injections and backtick termination</field>
     <description>ModSecurity: REQ - Detects MySQL comment-/space-obfuscated injections and backtick termination</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102722" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects chained SQL injection attempts</field>
     <description>ModSecurity: REQ - Detects chained SQL injection attempts</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102723" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects MySQL comments, conditions and ch</field>
     <description>ModSecurity: REQ - Detects MySQL comments, conditions and ch</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102724" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects MySQL comments, conditions and ch</field>
     <description>ModSecurity: REQ - Detects MySQL comments, conditions and ch(a)r injections</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102725" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects classic SQL injection probings</field>
     <description>ModSecurity: REQ - Detects classic SQL injection probings</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102726" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects basic SQL injection based on keyword alter or union</field>
     <description>ModSecurity: REQ - Detects basic SQL injection based on keyword alter or union</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102727" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Restricted SQL Character Anomaly Detection</field>
     <description>ModSecurity: REQ - Restricted SQL Character Anomaly Detection</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102728" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">SQL Comment Sequence Detected</field>
     <description>ModSecurity: REQ - SQL Comment Sequence Detected</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102729" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">SQL Hex Encoding Identified</field>
     <description>ModSecurity: REQ - SQL Hex Encoding Identified</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102730" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">SQLi bypass attempt by ticks or backticks detected</field>
     <description>ModSecurity: REQ - SQLi bypass attempt by ticks or backticks detected</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102731" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects HAVING injections</field>
     <description>ModSecurity: REQ - Detects HAVING injections</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102732" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Detects HAVING injections</field>
     <description>ModSecurity: REQ - Detects HAVING injections</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102733" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">Meta-Character Anomaly Detection Alert</field>
     <description>ModSecurity: REQ - Meta-Character Anomaly Detection Alert</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<rule id="102734" level="8">
     <if_sid>101142</if_sid>
     <field name="transaction.messages">SQLi bypass attempt by ticks detected</field>
     <description>ModSecurity: REQ - SQLi bypass attempt by ticks detected</description>
     <group>APPLICATION-ATTACK-SQLI</group>
</rule>

<!-- REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION 750 -->

<rule id="102750" level="3">
     <if_sid>101143</if_sid>
     <field name="transaction.messages">Possible Session Fixation Attack: Setting Cookie Values in HTML</field>
     <description>ModSecurity: REQ - Possible Session Fixation Attack: Setting Cookie Values in HTML</description>
     <group>APPLICATION-ATTACK-SESSION-FIXATION</group>
</rule>

<rule id="102751" level="3">
     <if_sid>101143</if_sid>
     <field name="transaction.messages">Possible Session Fixation Attack: SessionID Parameter Name with Off-Domain Referer</field>
     <description>ModSecurity: REQ - Possible Session Fixation Attack: SessionID Parameter Name with Off-Domain Referer</description>
     <group>APPLICATION-ATTACK-SESSION-FIXATION</group>
</rule>

<rule id="102752" level="3">
     <if_sid>101143</if_sid>
     <field name="transaction.messages">Possible Session Fixation Attack: SessionID Parameter Name with No Referer</field>
     <description>ModSecurity: REQ - Possible Session Fixation Attack: SessionID Parameter Name with No Referer</description>
     <group>APPLICATION-ATTACK-SESSION-FIXATION</group>
</rule>

<!-- REQUEST-944-APPLICATION-ATTACK-JAVA 800 -->

<rule id="102800" level="3">
     <if_sid>101144</if_sid>
     <field name="transaction.messages">Remote Command Execution: Suspicious Java class detected</field>
     <description>ModSecurity: REQ - Remote Command Execution: Suspicious Java class detected</description>
     <group>APPLICATION-ATTACK-JAVA</group>
</rule>

<rule id="102801" level="3">
     <if_sid>101144</if_sid>
     <field name="transaction.messages">Remote Command Execution: Java process spawn</field>
     <description>ModSecurity: REQ - Remote Command Execution: Java process spawn (CVE-2017-9805)</description>
     <group>APPLICATION-ATTACK-JAVA</group>
</rule>

<rule id="102802" level="3">
     <if_sid>101144</if_sid>
     <field name="transaction.messages">Remote Command Execution: Java serialization</field>
     <description>ModSecurity: REQ - Remote Command Execution: Java serialization (CVE-2015-4852)</description>
     <group>APPLICATION-ATTACK-JAVA</group>
</rule>

<rule id="102803" level="3">
     <if_sid>101144</if_sid>
     <field name="transaction.messages">Suspicious Java class detected</field>
     <description>ModSecurity: REQ - Suspicious Java class detected</description>
     <group>APPLICATION-ATTACK-JAVA</group>
</rule>

<rule id="102804" level="3">
     <if_sid>101144</if_sid>
     <field name="transaction.messages">Magic bytes Detected, probable java serialization in use</field>
     <description>ModSecurity: REQ - Magic bytes Detected, probable java serialization in use</description>
     <group>APPLICATION-ATTACK-JAVA</group>
</rule>

<rule id="102805" level="3">
     <if_sid>101144</if_sid>
     <field name="transaction.messages">Magic bytes Detected Base64 Encoded, probable java serialization in use</field>
     <description>ModSecurity: REQ - Magic bytes Detected Base64 Encoded, probable java serialization in use</description>
     <group>APPLICATION-ATTACK-JAVA</group>
</rule>

<rule id="102806" level="3">
     <if_sid>101144</if_sid>
     <field name="transaction.messages">Remote Command Execution: Java serialization (CVE-2015-4852)</field>
     <description>ModSecurity: REQ - Remote Command Execution: Java serialization (CVE-2015-4852)</description>
     <group>APPLICATION-ATTACK-JAVA</group>
</rule>

<rule id="102807" level="3">
     <if_sid>101144</if_sid>
     <field name="transaction.messages">Remote Command Execution: Suspicious Java method detected</field>
     <description>ModSecurity: REQ - Remote Command Execution: Suspicious Java method detected</description>
     <group>APPLICATION-ATTACK-JAVA</group>
</rule>

<rule id="102808" level="3">
     <if_sid>101144</if_sid>
     <field name="transaction.messages">Base64 encoded string matched suspicious keyword</field>
     <description>ModSecurity: REQ - Base64 encoded string matched suspicious keyword</description>
     <group>APPLICATION-ATTACK-JAVA</group>
</rule>

<!-- REQUEST-949-BLOCKING-EVALUATION 850 -->

<rule id="102850" level="3">
     <if_sid>101149</if_sid>
     <field name="transaction.messages">Request Denied by IP Reputation Enforcement</field>
     <description>ModSecurity: REQ - Request Denied by IP Reputation Enforcement</description>
     <group>BLOCKING-EVALUATION</group>
</rule>

<!-- RESPONSE-950-DATA-LEAKAGES 900 -->

<rule id="102900" level="8">
     <if_sid>101150</if_sid>
     <field name="transaction.messages">Directory Listing</field>
     <description>ModSecurity: RES - Directory Listing</description>
     <group>DATA-LEAKAGE</group>
</rule>

<rule id="102901" level="8">
     <if_sid>101150</if_sid>
     <field name="transaction.messages">CGI source code leakage</field>
     <description>ModSecurity: RES - CGI source code leakage</description>
     <group>DATA-LEAKAGE</group>
</rule>

<rule id="102902" level="8">
     <if_sid>101150</if_sid>
     <field name="transaction.messages">The Application Returned a 500-Level Status Code</field>
     <description>ModSecurity: RES - The Application Returned a 500-Level Status Code</description>
     <group>DATA-LEAKAGE</group>
</rule>

<!-- RESPONSE-951-DATA-LEAKAGES-SQL 950 -->

<rule id="102950" level="8">
     <if_sid>101151</if_sid>
     <field name="transaction.messages">Microsoft Access SQL Information Leakage</field>
     <description>ModSecurity: RES - Microsoft Access SQL Information Leakage</description>
     <group>DATA-LEAKAGES-SQL</group>
</rule>

<rule id="102951" level="8">
     <if_sid>101151</if_sid>
     <field name="transaction.messages">Oracle SQL Information Leakage</field>
     <description>ModSecurity: RES - Oracle SQL Information Leakage</description>
     <group>DATA-LEAKAGES-SQL</group>
</rule>

<rule id="102952" level="8">
     <if_sid>101151</if_sid>
     <field name="transaction.messages">DB2 SQL Information Leakage</field>
     <description>ModSecurity: RES - DB2 SQL Information Leakage</description>
     <group>DATA-LEAKAGES-SQL</group>
</rule>

<rule id="102953" level="8">
     <if_sid>101151</if_sid>
     <field name="transaction.messages">EMC SQL Information Leakage</field>
     <description>ModSecurity: RES - EMC SQL Information Leakage</description>
     <group>DATA-LEAKAGES-SQL</group>
</rule>

<rule id="102954" level="8">
     <if_sid>101151</if_sid>
     <field name="transaction.messages">firebird SQL Information Leakage</field>
     <description>ModSecurity: RES - firebird SQL Information Leakage</description>
     <group>DATA-LEAKAGES-SQL</group>
</rule>

<rule id="102955" level="8">
     <if_sid>101151</if_sid>
     <field name="transaction.messages">Frontbase SQL Information Leakage</field>
     <description>ModSecurity: RES - Frontbase SQL Information Leakage</description>
     <group>DATA-LEAKAGES-SQL</group>
</rule>

<rule id="102956" level="8">
     <if_sid>101151</if_sid>
     <field name="transaction.messages">hsqldb SQL Information Leakage</field>
     <description>ModSecurity: RES - hsqldb SQL Information Leakage</description>
     <group>DATA-LEAKAGES-SQL</group>
</rule>

<rule id="102957" level="8">
     <if_sid>101151</if_sid>
     <field name="transaction.messages">informix SQL Information Leakage</field>
     <description>ModSecurity: RES - informix SQL Information Leakage</description>
     <group>DATA-LEAKAGES-SQL</group>
</rule>

<rule id="102958" level="8">
     <if_sid>101151</if_sid>
     <field name="transaction.messages">ingres SQL Information Leakage</field>
     <description>ModSecurity: RES - ingres SQL Information Leakage</description>
     <group>DATA-LEAKAGES-SQL</group>
</rule>

<rule id="102959" level="8">
     <if_sid>101151</if_sid>
     <field name="transaction.messages">interbase SQL Information Leakage</field>
     <description>ModSecurity: RES - interbase SQL Information Leakage</description>
     <group>DATA-LEAKAGES-SQL</group>
</rule>

<rule id="102960" level="8">
     <if_sid>101151</if_sid>
     <field name="transaction.messages">maxDB SQL Information Leakage</field>
     <description>ModSecurity: RES - maxDB SQL Information Leakage</description>
     <group>DATA-LEAKAGES-SQL</group>
</rule>

<rule id="102961" level="8">
     <if_sid>101151</if_sid>
     <field name="transaction.messages">mssql SQL Information Leakage</field>
     <description>ModSecurity: RES - mssql SQL Information Leakage</description>
     <group>DATA-LEAKAGES-SQL</group>
</rule>

<rule id="102962" level="8">
     <if_sid>101151</if_sid>
     <field name="transaction.messages">mysql SQL Information Leakage</field>
     <description>ModSecurity: RES - mysql SQL Information Leakage</description>
     <group>DATA-LEAKAGES-SQL</group>
</rule>

<rule id="102963" level="8">
     <if_sid>101151</if_sid>
     <field name="transaction.messages">postgres SQL Information Leakage</field>
     <description>ModSecurity: RES - postgres SQL Information Leakage</description>
     <group>DATA-LEAKAGES-SQL</group>
</rule>

<rule id="102964" level="8">
     <if_sid>101151</if_sid>
     <field name="transaction.messages">sqlite SQL Information Leakage</field>
     <description>ModSecurity: RES - sqlite SQL Information Leakage</description>
     <group>DATA-LEAKAGES-SQL</group>
</rule>

<rule id="102965" level="8">
     <if_sid>101151</if_sid>
     <field name="transaction.messages">Sybase SQL Information Leakage</field>
     <description>ModSecurity: RES - Sybase SQL Information Leakage</description>
     <group>DATA-LEAKAGES-SQL</group>
</rule>

<!-- RESPONSE-952-DATA-LEAKAGES-JAVA 000 -->

<rule id="103000" level="8">
     <if_sid>101152</if_sid>
     <field name="transaction.messages">Java Source Code Leakage</field>
     <description>ModSecurity: RES - Java Source Code Leakage</description>
     <group>DATA-LEAKAGES-JAVA</group>
</rule>

<rule id="103001" level="8">
     <if_sid>101152</if_sid>
     <field name="transaction.messages">Java Errors</field>
     <description>ModSecurity: RES - Java Errors</description>
     <group>DATA-LEAKAGES-JAVA</group>
</rule>

<!-- RESPONSE-953-DATA-LEAKAGES-PHP 050 -->

<rule id="103050" level="8">
     <if_sid>101153</if_sid>
     <field name="transaction.messages">PHP Information Leakage</field>
     <description>ModSecurity: RES - PHP Information Leakage</description>
     <group>DATA-LEAKAGES-PHP</group>
</rule>

<rule id="103051" level="8">
     <if_sid>101153</if_sid>
     <field name="transaction.messages">PHP source code leakage</field>
     <description>ModSecurity: RES - PHP source code leakage</description>
     <group>DATA-LEAKAGES-PHP</group>
</rule>

<!-- RESPONSE-954-DATA-LEAKAGES-IIS 100 -->

<rule id="103100" level="8">
     <if_sid>101154</if_sid>
     <field name="transaction.messages">Disclosure of IIS install location</field>
     <description>ModSecurity: RES - Disclosure of IIS install location</description>
     <group>DATA-LEAKAGES-IIS</group>
</rule>

<rule id="103101" level="8">
     <if_sid>101154</if_sid>
     <field name="transaction.messages">Application Availability Error</field>
     <description>ModSecurity: RES - Application Availability Error</description>
     <group>DATA-LEAKAGES-IIS</group>
</rule>

<rule id="103102" level="8">
     <if_sid>101154</if_sid>
     <field name="transaction.messages">IIS Information Leakage</field>
     <description>ModSecurity: RES - IIS Information Leakage</description>
     <group>DATA-LEAKAGES-IIS</group>
</rule>

<!-- RESPONSE-959-BLOCKING-EVALUATION 150 -->

<!-- RESPONSE-980-CORRELATION 200 -->

<!-- CUSTOM RULES 250 -->

<!-- BOTs -->

<rule id="103250" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.request.headers.User-Agent">bot|Bot</field>
     <field name="transaction.response.http_code">^2</field>
     <description>ModSecurity: REQ - Bot Success</description>
     <group>bot,bot_success</group>
</rule>

<rule id="103251" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.request.headers.User-Agent">bot|Bot</field>
     <field name="transaction.response.http_code">^4</field>     
     <description>ModSecurity: REQ - Bot Forbidden</description>
     <group>bot,bot_forbidden</group>
</rule>

<rule id="103252" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.request.headers.From">bot|Bot</field>
     <field name="transaction.response.http_code">^2</field>
     <description>ModSecurity: REQ - Bot Success</description>
     <group>bot,bot_success</group>
</rule>

<rule id="103253" level="3">
     <if_group>http_code</if_group>
     <field name="transaction.request.headers.From">bot|Bot</field>
     <field name="transaction.response.http_code">^4</field>     
     <description>ModSecurity: REQ - Bot Forbidden</description>
     <group>bot,bot_forbidden</group>
</rule>

</group>